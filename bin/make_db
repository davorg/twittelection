#!/bin/bash

dir=$(dirname "$0")
# shellcheck source=bin/func_defs
. "$dir/func_defs"

check_vars

# Drop existing database
echo "DROP DATABASE IF EXISTS $TE_DB" | mysql -u$TE_USER -p$TE_PASS

# Create databsae
echo "CREATE DATABASE $TE_DB" | mysql -u$TE_USER -p$TE_PASS

# Load DDL
mysql -u$TE_USER -p$TE_PASS -D$TE_DB < db/twittelect.sql

# Load data
mysql -u$TE_USER -p$TE_PASS -D$TE_DB < db/constituency.dat
mysql -u$TE_USER -p$TE_PASS -D$TE_DB < db/party.dat

if [[ -f db/candidate.tsv ]]
then
  bin/load_cand
fi

